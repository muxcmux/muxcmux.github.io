!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){t.exports=i(2)},function(t,e,i){},function(t,e,i){"use strict";i.r(e);i(1);class s{constructor(t={}){this.xDown=null,this.yDown=null,this.options=t,this.handleTouchStart=this.handleTouchStart.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this),(this.options.element||document).addEventListener("touchstart",this.handleTouchStart,!1),(this.options.element||document).addEventListener("touchmove",this.handleTouchMove,!1)}onLeft(){this.options.onLeft()}onRight(){this.options.onRight()}onUp(){this.options.onUp()}onDown(){this.options.onDown()}static getTouches(t){return t.touches}handleTouchStart(t){t.preventDefault();const e=s.getTouches(t)[0];this.xDown=e.clientX,this.yDown=e.clientY}handleTouchMove(t){if(t.preventDefault(),!this.xDown||!this.yDown)return;let e=t.touches[0].clientX,i=t.touches[0].clientY,s=this.xDown-e,n=this.yDown-i;Math.abs(s)>Math.abs(n)?s>0&&this.options.onLeft?this.onLeft():this.options.onRight&&this.onRight():n>0&&this.options.onUp?this.onUp():this.options.onDown&&this.onDown(),this.xDown=null,this.yDown=null}}class n{constructor(t){this.element=t,this.canvas=t.getElementsByTagName("canvas")[0],this.beginModal=t.getElementsByClassName("snake-begin-modal")[0],this.endModal=t.getElementsByClassName("snake-end-modal")[0],this.hiScore=t.getElementsByClassName("snake-hi-score")[0],this.keyIsPressed=!1,this.baseSpeed=8,this.speedGainPerLevel=4,this.then=Date.now(),this.snakeArray,this.direction,this.food,this.score,this.level,this.speed,this.then,this.elapsed,this.msPerFrame,this.playing=!1}done(){this.beginModal.classList.add("hidden"),this.endModal.classList.add("hidden"),this.canvas.classList.add("hidden"),this.ctx.clearRect(0,0,this.width,this.height)}countdown(){if(this.playing)return;this.attachControls(),this.playing=!0,this.beginModal.classList.remove("hidden"),this.canvas.classList.remove("hidden"),this.setupCanvas(),this.setupGrid();const t=[3,2,1,"Go!"];setTimeout(()=>{this.init()},1e3*t.length+1);for(let e=0;e<t.length;e++)setTimeout(()=>{this.beginModal.textContent=t[e]},1e3*e)}getColor(t){return window.getComputedStyle(this.element).getPropertyValue("--"+t).trim()}setupGrid(){const t=~~(Math.max(window.innerWidth,window.innerHeight)/40),e=t,i=t,s=~~(this.width/e),n=this.width/s,h=~~(this.height/i),o=this.height/h,r=[];for(let t=0;t<s;t++)for(let e=0;e<h;e++)r.push({x:t,y:e});this.grid={slots:r,width:s,height:h,cell:{width:n,height:o}}}setupCanvas(){const t=window.devicePixelRatio||1,e=this.canvas.getBoundingClientRect(),i=e.width,s=e.height;this.canvas.width=i*t,this.canvas.height=s*t,this.canvas.style.width=i+"px",this.canvas.style.height=s+"px",this.ctx=this.canvas.getContext("2d"),this.ctx.scale(t,t),this.width=i,this.height=s}init(){window.cancelAnimationFrame(this.loop),this.beginModal.classList.add("hidden"),this.endModal.classList.add("hidden"),this.playing=!0,this.changeDirection("right"),this.score=0,this.level=0,this.increaseLevel(),this.createSnake(),this.createFood(),this.loop=requestAnimationFrame(()=>this.tick()),window.ga&&window.ga("send","event",{eventCategory:"Snake",eventAction:"play",eventValue:1})}increaseLevel(){this.level+=1,this.speed=this.baseSpeed+this.level*this.speedGainPerLevel,this.msPerFrame=1e3/this.speed}createSnake(){this.snakeArray=[];const t={x:window.innerWidth>=900?~~(this.grid.width/4):0,y:~~(this.grid.height/3)};for(let e=4;e>=0;e--)this.snakeArray.push({x:t.x+e,y:t.y})}getAvailableSlots(){const t=[];for(let e=0;e<this.grid.slots.length;e++){let i=!0;const s=this.grid.slots[e];for(let t=0;t<this.snakeArray.length;t++){const e=this.snakeArray[t];e.x==s.x&&e.y==s.y&&(i=!1)}i&&t.push(s)}return t}createFood(){const t=this.getAvailableSlots();this.food=t[~~(Math.random()*(t.length-1))]}die(){window.cancelAnimationFrame(this.loop),this.playing=!1,this.blowUp(),this.displayHiScore()}displayHiScore(){let t="Weak.";this.score>=10&&this.score<20&&(t="Srsly?"),this.score>=20&&this.score<30&&(t="Not bad!"),this.score>=30&&this.score<40&&(t="Awesome!"),this.score>=40&&this.score<50&&(t="Insane!"),this.score>=50&&this.score<60&&(t="Wicked!"),this.score>=60&&this.score<70&&(t="Outstanding!"),this.score>=70&&(t="Get a life."),this.hiScore.textContent=t+" Hi score: "+this.score,this.endModal.classList.remove("hidden"),window.ga&&window.ga("send","event",{eventCategory:"Snake",eventAction:"hi_score",eventValue:this.score})}blowUp(){this.elapsed=0,this.then=new Date,this.deadParticles=[];for(let t=0;t<this.snakeArray.length;t++){const e=this.snakeArray[t],i=2+~~(3*Math.random()),s=(this.grid.cell.width-1)/i,n=(this.grid.cell.height-1)/i,h=[];for(let t=0;t<i;t++)for(let o=0;o<i;o++){const i=0,r=e.x*this.grid.cell.width+t*s+.5,a=e.y*this.grid.cell.height+o*n+.5,l=r+Math.floor(6*Math.random())*Math.random()*this.grid.cell.width*(Math.random()<.5?-1:1),d=a+Math.floor(6*Math.random())*Math.random()*this.grid.cell.height*(Math.random()<.5?-1:1),c=0,g=20+Math.floor(180*Math.random());h.push({x_from:r,y_from:a,x_to:l,y_to:d,width:s,height:n,progress:i,rotate:c,rotate_to:g})}this.deadParticles.push(h)}this.explode()}explode(){this.ctx.clearRect(0,0,this.width,this.height);const t=new Date;this.elapsed+=Math.min(t-this.then,100),this.then=t,this.updateDeadParticles(),this.drawDeadParticles(),this.elapsed<=5e3&&(this.loop=window.requestAnimationFrame(()=>this.explode()))}updateDeadParticles(){for(let t=0;t<this.deadParticles.length;t++){const e=this.deadParticles[t];for(let i=0;i<e.length;i++){const s=e[i],n=15*t;s.progress+=this.ease(this.elapsed-n,0,1-s.progress,6e3),s.x_from=this.ease(this.elapsed-n,s.x_from,s.x_to-s.x_from,600),s.y_from=this.ease(this.elapsed-n,s.y_from,s.y_to-s.y_from,600),s.rotate=s.progress*s.rotate_to}}}drawDeadParticles(){const t=this.deadParticles.flat(),e=this.getColor("snake-cell-color");for(let i=0;i<t.length;i++){const s=t[i];this.ctx.save(),this.ctx.translate(s.x_from+s.width/2,s.y_from+s.height/2),this.ctx.rotate(s.rotate*Math.PI/180),this.ctx.translate(-(s.x_from+s.width/2),-(s.y_from+s.height/2)),this.ctx.fillStyle=e,this.ctx.fillRect(s.x_from,s.y_from,s.width,s.height),this.ctx.restore()}}ease(t,e,i,s){return t<=0?e:t==s?e+i:i*(1-Math.pow(2,-1*t/s))+e}tick(){const t=new Date;if(this.elapsed=t-this.then,this.elapsed>this.msPerFrame){this.then=t-this.elapsed%this.msPerFrame;let e,i=this.snakeArray[0].x,s=this.snakeArray[0].y;if("right"==this.direction?i++:"left"==this.direction?i--:"up"==this.direction?s--:"down"==this.direction&&s++,i<=-1||i>=this.grid.width||s<=-1||s>=this.grid.height||this.checkCollision(i,s,this.snakeArray))return void this.die();i==this.food.x&&s==this.food.y?(e={x:i,y:s},this.eatFood()):(e=this.snakeArray.pop(),e.x=i,e.y=s),this.snakeArray.unshift(e),this.paint(),this.keyIsPressed=!1}this.loop=requestAnimationFrame(()=>this.tick())}eatFood(){this.score++,this.score%10||this.increaseLevel(),this.createFood(),window.ga&&window.ga("send","event",{eventCategory:"Snake",eventAction:"eat_food",eventValue:1})}paint(){this.ctx.clearRect(0,0,this.width,this.height),this.paintSnake(),this.paintFood(),this.paintScore()}paintSnake(){for(let t=0;t<this.snakeArray.length;t++)this.paintCell(this.snakeArray[t].x,this.snakeArray[t].y,this.getColor("snake-cell-color"))}paintFood(){this.paintCell(this.food.x,this.food.y,this.getColor("snake-food-color"))}paintScore(){const t="Level: "+this.level+" Score: "+this.score;this.ctx.font="normal 12pt Menlo, Consolas, Courier",this.ctx.textAlign="left",this.ctx.fillStyle=this.getColor("snake-text-color"),this.ctx.fillText(t,5,this.height-5)}paintCell(t,e,i){this.ctx.fillStyle=i,this.ctx.fillRect(t*this.grid.cell.width,e*this.grid.cell.height,this.grid.cell.width,this.grid.cell.height),this.ctx.strokeStyle=this.getColor("snake-border-color"),this.ctx.strokeRect(t*this.grid.cell.width,e*this.grid.cell.height,this.grid.cell.width,this.grid.cell.height)}checkCollision(t,e,i){for(let s=0;s<i.length;s++)if(i[s].x==t&&i[s].y==e)return!0;return!1}changeDirection(t){this.playing&&(this.direction=t)}reverse(){if(!this.playing)return;const t=this.snakeArray.length-1;this.snakeArray[t].x<this.snakeArray[t-1].x?this.changeDirection("left"):this.snakeArray[t].x>this.snakeArray[t-1].x?this.changeDirection("right"):this.snakeArray[t].y<this.snakeArray[t-1].y?this.changeDirection("up"):this.snakeArray[t].y>this.snakeArray[t-1].y&&this.changeDirection("down"),this.snakeArray.reverse()}attachControls(){new s({element:this.canvas,onUp:()=>"down"==this.direction?this.reverse():this.changeDirection("up"),onDown:()=>"up"==this.direction?this.reverse():this.changeDirection("down"),onLeft:()=>"right"==this.direction?this.reverse():this.changeDirection("left"),onRight:()=>"left"==this.direction?this.reverse():this.changeDirection("right")}),document.addEventListener("keydown",t=>{const e=t.keyCode;this.keyIsPressed||(37==e?"right"==this.direction?this.reverse():this.changeDirection("left"):38==e?"down"==this.direction?this.reverse():this.changeDirection("up"):39==e?"left"==this.direction?this.reverse():this.changeDirection("right"):40==e&&("up"==this.direction?this.reverse():this.changeDirection("down"))),[37,38,39,40].includes(e)&&(t.preventDefault(),this.keyIsPressed=!0)})}}document.addEventListener("DOMContentLoaded",(function(){document.getElementById("snake")&&(window.Snake=new n(document.getElementById("snake")),document.getElementById("play-snake").addEventListener("click",(function(t){t.preventDefault(),window.Snake.countdown(),document.getElementById("root").classList.add("dimmed")})),document.getElementById("replay-snake").addEventListener("click",(function(t){t.preventDefault(),window.Snake.init()})),document.getElementById("stop-snake").addEventListener("click",(function(t){t.preventDefault(),window.Snake.done(),document.getElementById("root").classList.remove("dimmed")})))}))}]);