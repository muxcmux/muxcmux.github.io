<!DOCTYPE html>
<html lang="en-gb">

<head>
  
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<title>Antoni Karasavov  | Ghetto Brightness Control</title>
<meta name="viewport" content="width=device-width,minimum-scale=1">


<meta name="robots" content="index, follow">


<style>@font-face{font-family:'IBM Plex Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexmono/v7/-F63fjptAgt5VM-kVkqdyU8n1iIq131nj-otFQ.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'IBM Plex Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexmono/v7/-F63fjptAgt5VM-kVkqdyU8n1isq131nj-otFQ.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'IBM Plex Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexmono/v7/-F63fjptAgt5VM-kVkqdyU8n1iAq131nj-otFQ.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'IBM Plex Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexmono/v7/-F63fjptAgt5VM-kVkqdyU8n1iEq131nj-otFQ.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'IBM Plex Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexmono/v7/-F63fjptAgt5VM-kVkqdyU8n1i8q131nj-o.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'IBM Plex Serif';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizBREVNn1dOx-zrZ2X3pZvkTiUa6zgTjnTLgNuZ5w.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'IBM Plex Serif';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizBREVNn1dOx-zrZ2X3pZvkTiUa6zETjnTLgNuZ5w.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'IBM Plex Serif';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizBREVNn1dOx-zrZ2X3pZvkTiUa6zoTjnTLgNuZ5w.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'IBM Plex Serif';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizBREVNn1dOx-zrZ2X3pZvkTiUa6zsTjnTLgNuZ5w.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'IBM Plex Serif';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizBREVNn1dOx-zrZ2X3pZvkTiUa6zUTjnTLgNs.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'IBM Plex Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizDREVNn1dOx-zrZ2X3pZvkTiUS2zcZiVbJsNo.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'IBM Plex Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizDREVNn1dOx-zrZ2X3pZvkTiUb2zcZiVbJsNo.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'IBM Plex Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizDREVNn1dOx-zrZ2X3pZvkTiUQ2zcZiVbJsNo.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'IBM Plex Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizDREVNn1dOx-zrZ2X3pZvkTiUR2zcZiVbJsNo.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'IBM Plex Serif';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizDREVNn1dOx-zrZ2X3pZvkTiUf2zcZiVbJ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'IBM Plex Serif';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizAREVNn1dOx-zrZ2X3pZvkTi3A_yI5q1vjitOh3oc.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'IBM Plex Serif';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizAREVNn1dOx-zrZ2X3pZvkTi3A_yIwq1vjitOh3oc.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'IBM Plex Serif';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizAREVNn1dOx-zrZ2X3pZvkTi3A_yI7q1vjitOh3oc.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'IBM Plex Serif';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizAREVNn1dOx-zrZ2X3pZvkTi3A_yI6q1vjitOh3oc.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'IBM Plex Serif';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/ibmplexserif/v10/jizAREVNn1dOx-zrZ2X3pZvkTi3A_yI0q1vjitOh.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style>


<style>/*!modern-normalize | MIT License | https://github.com/sindresorhus/modern-normalize*/html{box-sizing:border-box}*,:after,:before{box-sizing:inherit}:root{-moz-tab-size:4;-o-tab-size:4;tab-size:4}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}hr{height:0}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{padding:0}progress{vertical-align:baseline}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}:root{--color-border:rgba(138,145,153,0.23);--color-bg:#fafafa;--color-fg:#575f66;--color-blue:#399ee6;--color-danube:#709ecc;--color-turquoise:#55d4b4;--color-green:#99bf42;--color-red:#f27983;--color-orange:#ff9940;--color-darker-orange:#fa8d3e;--color-purple:#a37acc;--color-teal:#4cbf99;--color-alt-bg:rgba(138,145,153,0.1);--color-logo-letter:#575f66;--color-logo-gradient:url(#grad);--font-sans:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--font-serif:"IBM Plex Serif",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--font-mono:"IBM Plex Mono",SFMono-Regular,Consolas,"Liberation Mono",Menlo,Courier,monospace;--type-base:calc(0.9em + 0.6vw)}@media screen and (min-width:45em){:root{--type-base:calc(0.7em + 0.6vw)}}@media screen and (min-width:91em){:root{--type-base:1.25em}}@media screen and (prefers-color-scheme:dark){:root{--color-border:#000;--color-bg:#1f2430;--color-fg:#cbccc6;--color-blue:#73d0ff;--color-danube:#77a8d9;--color-turquoise:#5ccfe6;--color-green:#a6cc70;--color-red:#f27983;--color-orange:#fc6;--color-darker-orange:#ffa759;--color-purple:#d4bfff;--color-teal:#95e6cb;--color-alt-bg:#101521;--color-logo-letter:#6994bf;--color-logo-gradient:url(#grad-dark)}}.center{text-align:center}.green{color:var(--color-green)}.red{color:var(--color-red)}.muted{opacity:.6}.mb-2{margin-bottom:2em}.mt-4{margin-top:4em}.mono{font-size:.9em;font-family:var(--font-mono)}.column{margin:0 auto;padding:0 1em;max-width:40em;position:relative}html{font-size:var(--type-base);line-height:1.8}body{background:var(--color-bg);color:var(--color-fg);font-family:var(--font-serif);display:flex;flex-direction:column}body>footer,body>header{justify-self:center;align-self:center}body>footer a,body>header a{display:block}body>footer svg,body>header svg{width:100%;height:100%}body>main{flex:1}body>footer{padding:2em}body>footer a{width:1.6em;height:1.6em;opacity:.8}body>header{padding:1.5em}body>header a{width:4em;height:4em}@media screen and (min-width:70em){body{min-height:100vh}}#a-box{fill:var(--color-logo-gradient)}#a-a{fill:var(--color-logo-letter)}b,strong{font-weight:600}a{transition:color .2s ease;color:var(--color-blue)}a:visited{color:var(--color-purple)}a:hover,a:visited a:hover{color:var(--color-teal)}code,kbd,pre,samp{font-family:var(--font-mono);font-size:.9em}code,kbd,samp{background:var(--color-alt-bg);padding:0 .25em}code{word-break:break-all;border-bottom:2px solid var(--color-border)}@media screen and (min-width:45em){code{word-break:normal}}pre{line-height:1.45em;overflow-y:scroll;background:var(--color-alt-bg);padding:.5em}pre code{background:0 0;border-bottom:none}h1,h2,h3,h4,h5,h6{font-family:var(--font-mono);font-weight:400;line-height:1.3;color:var(--color-orange)}h1 a,h2 a,h3 a,h4 a,h5 a,h6 a{text-decoration:none}h1{font-size:1.4em;color:var(--color-darker-orange)}@media screen and (min-width:45em){h1{font-size:1.8em}}h2{font-size:1.2em}@media screen and (min-width:45em){h2{font-size:1.5em}}h3{font-size:1.1em}h4{font-size:1em;color:var(--color-fg)}blockquote{margin:3em 0;line-height:1.5;padding:.2em 1em .2em 3.5em;font-size:1.1em;font-family:var(--font-mono);opacity:.7;border-left:3px solid var(--color-danube);position:relative}blockquote:before{opacity:.4;font-size:5em;content:"â€œ";position:absolute;top:-.1em;left:.1em;line-height:1;font-family:var(--font-serif)}blockquote p{margin:0}ul{margin:1em 0;padding:0 0 0 2em}ul ul{margin:0;padding:0 0 0 1.4em}p{margin:1em 0}hr{height:1px;margin:2em 0;border:none;background:var(--color-fg);opacity:.3}main.root{transition:opacity 2s ease;flex:initial;text-align:center;width:100%;display:flex;flex-direction:column;justify-content:center;padding:1em}main.root.dimmed{opacity:.3}main.root>svg{width:6em;height:6em;margin:1rem auto}main.root small{margin:1em auto;opacity:.7}main.root p em,main.root p strong{background:var(--color-red);color:var(--color-bg);padding:0 .3em}main.root p em{background:var(--color-green);font-style:normal}main.root nav{margin:1em auto;display:flex;flex-direction:row}main.root nav a{display:block;width:2em;height:2em;text-decoration:none;margin:0 .3em;opacity:.3;transition:opacity .2s ease}main.root nav a:hover{opacity:1}main.root nav a svg path{fill:var(--color-fg)}@media screen and (min-width:70em){main.root{flex:1}}.work>small{position:absolute;top:3em;right:0;margin:0 1.5em}.work aside{display:flex;align-items:center}.work aside h1{font-weight:700;font-size:2em;font-family:var(--font-sans);color:var(--color-fg)}@media screen and (min-width:45em){.work>small{top:2em}.work aside{position:absolute;top:0;left:0;transform-origin:bottom left;transform:rotate(270deg)translate(-96%);width:100%;justify-content:flex-end}.work aside h1{font-weight:800;font-size:5em;margin:0;opacity:.1;order:1;line-height:1}}.post header{margin-bottom:1.5em;font-family:var(--font-mono)}.post header h1{margin:0 0 .5em}.post header time{font-size:.8em;color:var(--color-red)}.post header span{font-size:.8em}.post header a{font-size:.8em;text-decoration:none}.post header a,.post header a:visited{color:var(--color-green)}.post header a:hover{color:var(--color-teal)}.post .hero{display:block;margin:1em 0 1em -1em;width:100vw;max-height:18em;position:relative;overflow:hidden;background-size:cover}.post .hero img{display:block;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}@media screen and (min-width:45em){.post .hero{max-height:none;height:25em;margin:1em 0 1em calc((100vw - 38em)/-2);max-height:22em}}@media screen and (min-width:70em){.post .hero{width:100%;margin-left:0;max-height:22em}}.post .image{margin:2em 0 2em -1em;width:100vw}.post .image a{display:block;background-size:cover}.post .image img{width:100%;display:block;height:auto}.post .image figcaption{font-family:var(--font-mono);color:var(--color-danube);font-size:.8em;opacity:.8;margin:.5em 1em 0;text-align:center}@media screen and (min-width:45em){.post .image{margin:2em 0;width:100%}}.post .comments{margin:2em 0}.button{background:var(--color-blue);color:var(--color-bg);text-decoration:none;padding:.2em 1em;font-family:var(--font-mono);font-size:.9em;text-align:center;transition:background-color .2s ease}.button:hover{background:var(--color-teal)}.button:hover,.button:visited{color:var(--color-bg)}#snake{--snake-cell-color:var(--color-blue);--snake-food-color:var(--color-orange);--snake-text-color:var(--color-fg);--snake-border-color:var(--color-bg)}#snake canvas{position:absolute;top:0;left:0;width:100vw;height:100%;z-index:2}#snake canvas.hidden{display:none}#snake .snake-begin-modal,#snake .snake-end-modal{position:absolute;z-index:3;top:50%;left:50%;width:60%;transform:translate(-50%,-50%);background:var(--color-bg);border:3px solid var(--color-alt-bg);padding:.5em;display:flex;flex-direction:column;text-align:center}#snake .snake-begin-modal *,#snake .snake-end-modal *{margin:.5em}#snake .snake-begin-modal.hidden,#snake .snake-end-modal.hidden{display:none}#snake .snake-begin-modal{font-family:var(--font-mono);font-size:2em}@media screen and (min-width:45em){#snake .snake-begin-modal,#snake .snake-end-modal{padding:1em 3em;width:auto}}.post-list{list-style:none;margin:2em 0;padding:0}.post-list li{display:flex;flex-direction:column;margin:0 0 1.5em}.post-list li time{padding-right:1em}.post-list li h3{margin:0;flex:1}@media screen and (min-width:45em){.post-list li{flex-direction:row}.post-list li time{width:12em;text-align:right}}.chroma{--error:#f51818;--accent:#ff9940;--func:#f2ae49;--entity:#399ee6;--comment:#abb0b6;--string:#86b300;--keyword:#fa8d3e;--constant:#a37acc;--operator:#ed9366;--regexp:#4cbf99;--tag:#55b4d5;--markup:#fa8d3e;color:var(--color-fg);background-color:var(--color-alt-bg)}@media screen and (prefers-color-scheme:dark){.chroma{--error:#f33;--accent:#fc6;--func:#ffd580;--entity:#73d0ff;--comment:#5c6773;--string:#bae67e;--keyword:#ffa759;--constant:#d4bfff;--operator:#f29e74;--regexp:#95e6cb;--tag:#5ccfe6;--markup:#f28779}}.chroma .err{color:var(--error)}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block}.chroma .hl{display:block;width:100%;background-color:#ffc}.chroma .ln,.chroma .lnt{margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .k,.chroma .kc,.chroma .kd{color:var(--keyword)}.chroma .kn{color:var(--operator)}.chroma .kp,.chroma .kr,.chroma .kt{color:var(--keyword)}.chroma .na,.chroma .nc{color:var(--markup)}.chroma .no{color:var(--constant)}.chroma .nd,.chroma .ne,.chroma .nf,.chroma .nx{color:var(--markup)}.chroma .nt{color:var(--operator)}.chroma .l{color:var(--entity)}.chroma .dl,.chroma .ld,.chroma .s,.chroma .s2,.chroma .sa,.chroma .sb,.chroma .sc,.chroma .sd{color:var(--string)}.chroma .se{color:var(--entity)}.chroma .sh,.chroma .si,.chroma .sx{color:var(--string)}.chroma .sr{color:var(--regexp)}.chroma .s1{color:var(--string)}.chroma .ss{color:var(--accent)}.chroma .il,.chroma .m,.chroma .mb,.chroma .mf,.chroma .mh,.chroma .mi,.chroma .mo{color:var(--entity)}.chroma .o,.chroma .ow{color:var(--operator)}.chroma .c,.chroma .c1,.chroma .ch,.chroma .cm,.chroma .cp,.chroma .cpf,.chroma .cs{color:var(--comment)}.chroma .gd{color:var(--operator)}.chroma .ge{font-style:italic}.chroma .gi{color:#a6e22e}.chroma .gs{font-weight:700}.chroma .gu{color:#75715e}</style>










<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-28270884-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



  
</head>

<body>
  <header>
  <nav role="navigation">
    <a href="../../" title="Go to the main page">
      <svg viewBox="0 0 200 200" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    <linearGradient x1="20%" y1="0%" x2="80%" y2="100%" id="grad">
      <stop stop-color="#EEEEEE" offset="0%"></stop>
      <stop stop-color="#D8D8D8" offset="100%"></stop>
    </linearGradient>
    <linearGradient x1="20%" y1="0%" x2="80%" y2="100%" id="grad-dark">
      <stop stop-color="#33415E" offset="0%"></stop>
      <stop stop-color="#323A4C" offset="100%"></stop>
    </linearGradient>
  </defs>
  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
    <g>
      <path d="M0,0 L200,0 L200,200 L0,200 L0,0 Z M20,20 L20,180 L180,180 L180,20 L20,20 Z" id="a-box"></path>
      <path d="M148.88,146.38 L126.34,146.38 L120.46,130.56 L80.42,130.56 L74.54,146.38 L52,146.38 L87.98,53 L112.9,53 L148.88,146.38 Z M115,113.06 L100.44,72.88 L85.88,113.06 L115,113.06 Z" id="a-a" fill-rule="nonzero"></path>
    </g>
  </g>
</svg>
    </a>
  </nav>
</header>
  <main role="main">
    
<article class="column post">
  <header>
    <h1>Ghetto Brightness Control</h1>
    <time datetime="2020-05-20T17:23:17&#43;01:00">May 20, 2020</time>
    <span>in</span>
    <a href="../../posts/">/var/log</a>
  </header>

  

  <section class="body"><p>This is the second post in the series where I&rsquo;m trying to switch away from the mac for a while.</p>
<p>One of the things I miss is the ability to adjust brightness of my monitor with the multimedia keyboard keys. When at home, my mac is usually hooked up to a 22&quot; LG UltraFine, which controls its brightness automatically based on the ambient light sensor on the laptop, or I could adjust it by holding <code>ctrl</code> and using the brigthness keys on my MX Keys keyboard. If I plug the laptop into my Dell (which is usually hooked to the Linux desktop), I then use a tiny tool called <a href="https://github.com/MonitorControl/MonitorControl">MonitorControl</a> to control the brightness with the multimedia keys. I can&rsquo;t do that on the Linux desktop.</p>
<figure class="image">
<a href="../../posts/ghetto-brightness-control/brightness-slider.png" style="background-image: url(data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAAuUlEQVR4nESPTU4DMQyF33MySQhiQbkAYsHfZbkBC9iy4FSVWE4nFUzb&#43;KGZImHJXlif7O/Fu/snAMJ/cW0jtG5JEqiXNcV4UUpJAd5rreM48uXto7tcsjMFBluO1WQORDNJn&#43;&#43;vkAiRTMMwz/PhMD88PscQCHJYX3Utswx2csCYjSkYhOP3XrUylwy0afrabgFcb27i7ebq59S7&#43;9H/3G0NIS3C0Shpas13O5dKzvvWQghn8jcAAP//wWlK8ZtbLfgAAAAASUVORK5CYII=);">
  <img loading="lazy"
        srcset='../../posts/ghetto-brightness-control/brightness-slider_hu0039f9417ae8202c177c55ceb44de043_93318_800x0_resize_box_3.png 800w, ../../posts/ghetto-brightness-control/brightness-slider_hu0039f9417ae8202c177c55ceb44de043_93318_1200x0_resize_box_3.png 1200w, ../../posts/ghetto-brightness-control/brightness-slider_hu0039f9417ae8202c177c55ceb44de043_93318_1600x0_resize_box_3.png 1600w '
        src="../../posts/ghetto-brightness-control/brightness-slider.png"
  alt='Tapping the brightness buttons does move the slider in the taskbar but the monitor&#39;s brightness remains unchanged.'>
</a>
  <figcaption class="image-caption">Tapping the brightness buttons does move the slider in the taskbar but the monitor&#39;s brightness remains unchanged.</figcaption>
</figure>
<p>I did a bit of research online and the general consensus seems to be that you need a specific kernel extension to make it work for your particular setup. Screw that - there&rsquo;s gotta be another way. Digging a bit further reveals the way MonitorControl works on the mac is by talking to the monitor with a protocol called <a href="https://en.wikipedia.org/wiki/Display_Data_Channel">DDC/CI</a>, or Display Data Channel / Command Interface. It turns out <a href="https://www.ddcutil.com"><code>ddcutil</code></a> for Linux does just that.</p>
<p>It has a super simple command line interface. If you have more than one screen attached to your computer, you will need to work out which monitor&rsquo;s brightness you&rsquo;ll want to control:</p>
<pre><code>$ ddcutil detect
</code></pre>
<p>Next run</p>
<pre><code>$ ddcutil capabilities
</code></pre>
<p>and make a note of the number of the feature you&rsquo;d like to control. On my machine brightness is <code>10</code>, so to change it, the command is simply:</p>
<pre><code>$ ddcutil setvcp 10 50
</code></pre>
<p>where the argument after <code>setvcp</code> is the code for the brightness VCP feature, and the next one is the desired brightness value between 0-100. Easy!</p>
<p>Ok, so if there&rsquo;s a way to run this command every time I hit one of the brightness keys, then my all my troubles are over. I could set up a standard Ubuntu keyboard key assignment, e.g. pressing <code>Meta</code> + <code>+</code> would increase brightness, but I want to use the media keys for that.</p>
<p>If you read carefully, I did mention that my brightness multimedia keys are already moving the brightness slider back and forth. Luckily Pop_OS! stores this slider&rsquo;s value in a file</p>
<pre><code>$ cat /sys/class/backlight/acpi_video0/brightness
</code></pre>
<p>That&rsquo;s right, try changing the slider either with your mouse or with the keyboard and watch the contents of the file change. Another file stores the maximum value: <code>/sys/class/backlight/acpi_video0/max_brightness</code>. Nice! Let&rsquo;s put that in a script we can call once we have set our brightness to the desired level.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="ch">#!/bin/env ruby</span>
</span></span><span class="line"><span class="cl"><span class="n">slider_current</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;/sys/class/backlight/acpi_video0/brightness&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">slider_max</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;/sys/class/backlight/acpi_video0/max_brightness&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brightness_max</span> <span class="o">=</span> <span class="mi">100</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ratio</span> <span class="o">=</span> <span class="nb">Float</span><span class="p">(</span><span class="n">slider_current</span><span class="p">)</span> <span class="o">/</span> <span class="nb">Float</span><span class="p">(</span><span class="n">slider_max</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">brightness</span> <span class="o">=</span> <span class="p">(</span><span class="n">ratio</span> <span class="o">*</span> <span class="n">brightness_max</span><span class="p">)</span><span class="o">.</span><span class="n">to_i</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="sb">`ddcutil setvcp 10 </span><span class="si">#{</span><span class="n">brightness</span><span class="si">}</span><span class="sb">`</span>
</span></span></code></pre></div><p>Move the slider and run your script. Sweet! Now all we need is something that will run our script everytime the slider changes. I&rsquo;ll use a Rust program called <code>watchexec</code> which does exactly what you&rsquo;d think - it watches a file for changes and runs a command everytime it does. Time to put all that in a <code>systemd</code> service so it runs on the background at boot. Let&rsquo;s create a new service:</p>
<pre><code>[Unit]
Description=Ghetto brightness control
[Service]
Type=simple
Restart=on-failure
ExecStart=~/.cargo/bin/watchexec -w /sys/class/backlight/acpi_video0/brightness /usr/local/bin/ghetto-brightness-control
[Install]
WantedBy=default.target
</code></pre>
<p>You might need to expand <code>~</code> to the full home path and obviously substitute with the correct path to your script, but the rest should be more or less the same. Save that under <code>~/.local/share/systemd/user/ghetto-brightness-control.service</code> and then enable it:</p>
<pre><code>$ sudo systemctl --user enable ghetto-brightness-control.service
</code></pre>
<p>Well done! Now you can control the brightness of the monitor either by dragging the slider or tapping the multimedia keys.</p>
</section>

  
  
    <h5 class="mt-4">Other entries in <a href="../../series/linux-as-an-alternative-to-mac-for-work/">Linux as an alternative to mac for work</a></h5>

    <section class="series">
      
        <ul>
          
            
          
            
              <li><a href="../../posts/linux-dev-setup/">Development setup on Linux</a></li>
            
          
        </ul>
      
    </section>
  



  <section class="comments">
    <link rel="stylesheet" href="https://besedka.tonkata.com/themes/default.css">
<style>
.besedka-comment-preview {
  min-height: calc(75px - var(--type-base));
}
.besedka-anonymous-user .besedka-comment-preview {
  min-height: calc(116px - var(--type-base));
}
</style>
<script type="text/javascript" src="https://besedka.tonkata.com/comments.js"></script>
<div id="besedka" data-api="https://besedka.tonkata.com"></div>

  </section>

  <aside>



</aside>
</article>

  </main>
  <footer role="contentinfo">
  <a href="" title="Antoni Karasavov">
    <svg viewBox="0 0 200 200" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    <linearGradient x1="20%" y1="0%" x2="80%" y2="100%" id="grad">
      <stop stop-color="#EEEEEE" offset="0%"></stop>
      <stop stop-color="#D8D8D8" offset="100%"></stop>
    </linearGradient>
    <linearGradient x1="20%" y1="0%" x2="80%" y2="100%" id="grad-dark">
      <stop stop-color="#33415E" offset="0%"></stop>
      <stop stop-color="#323A4C" offset="100%"></stop>
    </linearGradient>
  </defs>
  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
    <g>
      <path d="M0,0 L200,0 L200,200 L0,200 L0,0 Z M20,20 L20,180 L180,180 L180,20 L20,20 Z" id="a-box"></path>
      <path d="M148.88,146.38 L126.34,146.38 L120.46,130.56 L80.42,130.56 L74.54,146.38 L52,146.38 L87.98,53 L112.9,53 L148.88,146.38 Z M115,113.06 L100.44,72.88 L85.88,113.06 L115,113.06 Z" id="a-a" fill-rule="nonzero"></path>
    </g>
  </g>
</svg>
  </a>
</footer>
  

<script type="text/javascript" src="../../app.231b50c1b1d04edc958aad768bb4185ed3eed1cf47008c2b0e6eb092f72ae74e.js" integrity="sha256-IxtQwbHQTtyViq12i7QYXtPu0c9HAIwrDm6wkvcq504="></script>
</body>

</html>